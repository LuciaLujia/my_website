<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8" />
  <title>Homework 3</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <!-- Slick Carousel --> 
  <link rel="stylesheet" href="/plugins/slick/slick.css" />
  <link rel="stylesheet" href="/plugins/slick/slick-theme.css" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="/plugins/font-awesome/css/font-awesome.min.css" />
  <!-- Bootstrap -->
  <link rel="stylesheet" href="/plugins/bootstrap/bootstrap.min.css" />
  <link rel="stylesheet" href="/plugins/magnafic-popup/magnific-popup.css" />

  <!-- Stylesheets -->
  
  <link href="/scss/style.min.css" rel="stylesheet" />

  <!--Favicon-->
  <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
  <link rel="icon" href="/images/favicon.png" type="image/x-icon" />
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=YOUR%20GOOGLE%20ANALYTICS%20CODE"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'YOUR GOOGLE ANALYTICS CODE');
  </script>
	
</head>

  <body>
    <nav class="navbar navbar-expand-lg fixed-top">
  <div class="container">
      <a href="/" class="navbar-brand">
          <img src="/images/site-navigation/logo.png" alt="site-logo">
      </a>
      <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#navbarCollapse">
          <span class="navbar-toggler-icon"></span>
          <span class="navbar-toggler-icon"></span>
          <span class="navbar-toggler-icon"></span>
      </button>
  
      <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
          <ul class="nav navbar-nav main-navigation">
              
              
                <li class="nav-item">
                  <a href="/#home" class="nav-link ">Home</a>
                </li>
              
                <li class="nav-item">
                  <a href="/#resume" class="nav-link ">Resume</a>
                </li>
              
                <li class="nav-item">
                  <a href="/#blog" class="nav-link ">Blog</a>
                </li>
              
                <li class="nav-item">
                  <a href="/#contact" class="nav-link ">Contact</a>
                </li>
              
          </ul>
          <div class="navbar-nav">
              <a href="/contact" class="hire_button">Hire Me Now</a>
          </div>
      </div>
  </div>
</nav>
    <div id="content">
      

<header class="breadCrumb">
  <div class="container">
    <div class="row">
      <div class="col-lg-10 col-md-12 offset-lg-1 offset-md-0 text-center">
        <h3 class="breadCrumb__title">Homework 3</h3>
        <nav aria-label="breadcrumb" class="d-flex justify-content-center">
          <ol class="breadcrumb align-items-center">
            <li class="breadcrumb-item"><a href=/>Home</a></li>
            <li class="breadcrumb-item"><a href=/blog>All Post</a></li>
            <li class="breadcrumb-item active" aria-current="page">Homework 3</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
</header>

<section class="section singleBlog">
  <div class="svg-img">
      <img src=/images/hero/figure-svg.svg alt="">
  </div>
  <div class="animate-shape">
      
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 600 600">
          <defs>
              <linearGradient id="d" x1="0.929" y1="0.111" x2="0.263" y2="0.935" gradientUnits="objectBoundingBox">
                  <stop offset="0" stop-color="#f1f6f9" />
                  <stop offset="1" stop-color="#f1f6f9" stop-opacity="0" />
              </linearGradient>
          </defs>
          <g data-name="blob-shape (3)">
              <path class="blob" fill="url(#d)"
                  d="M455.4 151.1c43.1 36.7 73.4 92.8 60.8 136.3-12.7 43.5-68.1 74.4-111.3 119.4-43.1 45-74 104.1-109.8 109-35.9 5-76.7-44.2-111.8-89.2-35.2-45-64.7-85.8-70.8-132.6-6-46.8 11.6-99.6 46.7-136.3 35.2-36.6 88-57.2 142.4-58.8 54.5-1.7 110.6 15.6 153.8 52.2z" />
          </g>
      </svg>
  </div>
  <div class="animate-pattern">
      <img src=/images/service/background-pattern.svg alt="background-shape">
  </div>
  <div class="container">
      <div class="row">
          <div class="col-lg-12">
              <div class="singleBlog__feature">
                  <img src=/images/single-blog/0.jpg alt="feature-image">
              </div>
          </div>
      </div>
      <div class="row mt-5">
          <div class="col-lg-12">
              <div class="singleBlog__content">
                  
<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>
<link href="/rmarkdown-libs/lightable/lightable.css" rel="stylesheet" />


<div id="youth-risk-behavior-surveillance" class="section level1">
<h1>Youth Risk Behavior Surveillance</h1>
<p>Every two years, the Centers for Disease Control and Prevention conduct the <a href="https://www.cdc.gov/healthyyouth/data/yrbs/index.htm">Youth Risk Behavior Surveillance System (YRBSS)</a> survey, where it takes data from high schoolers (9th through 12th grade), to analyze health patterns.<br />
We will work with a selected group of variables from a random sample of observations during one of the years the YRBSS was conducted.</p>
<div id="load-the-data" class="section level2">
<h2>Load the data</h2>
<p>This data is part of the <code>openintro</code> textbook and we can directly load and inspect it:</p>
<pre class="r"><code>data(yrbss)
glimpse(yrbss)</code></pre>
<pre><code>## Rows: 13,583
## Columns: 13
## $ age                      &lt;int&gt; 14, 14, 15, 15, 15, 15, 15, 14, 15, 15, 15...
## $ gender                   &lt;chr&gt; &quot;female&quot;, &quot;female&quot;, &quot;female&quot;, &quot;female&quot;, &quot;f...
## $ grade                    &lt;chr&gt; &quot;9&quot;, &quot;9&quot;, &quot;9&quot;, &quot;9&quot;, &quot;9&quot;, &quot;9&quot;, &quot;9&quot;, &quot;9&quot;, &quot;9...
## $ hispanic                 &lt;chr&gt; &quot;not&quot;, &quot;not&quot;, &quot;hispanic&quot;, &quot;not&quot;, &quot;not&quot;, &quot;n...
## $ race                     &lt;chr&gt; &quot;Black or African American&quot;, &quot;Black or Afr...
## $ height                   &lt;dbl&gt; NA, NA, 1.73, 1.60, 1.50, 1.57, 1.65, 1.88...
## $ weight                   &lt;dbl&gt; NA, NA, 84.4, 55.8, 46.7, 67.1, 131.5, 71....
## $ helmet_12m               &lt;chr&gt; &quot;never&quot;, &quot;never&quot;, &quot;never&quot;, &quot;never&quot;, &quot;did n...
## $ text_while_driving_30d   &lt;chr&gt; &quot;0&quot;, NA, &quot;30&quot;, &quot;0&quot;, &quot;did not drive&quot;, &quot;did ...
## $ physically_active_7d     &lt;int&gt; 4, 2, 7, 0, 2, 1, 4, 4, 5, 0, 0, 0, 4, 7, ...
## $ hours_tv_per_school_day  &lt;chr&gt; &quot;5+&quot;, &quot;5+&quot;, &quot;5+&quot;, &quot;2&quot;, &quot;3&quot;, &quot;5+&quot;, &quot;5+&quot;, &quot;5...
## $ strength_training_7d     &lt;int&gt; 0, 0, 0, 0, 1, 0, 2, 0, 3, 0, 3, 0, 0, 7, ...
## $ school_night_hours_sleep &lt;chr&gt; &quot;8&quot;, &quot;6&quot;, &quot;&lt;5&quot;, &quot;6&quot;, &quot;9&quot;, &quot;8&quot;, &quot;9&quot;, &quot;6&quot;, &quot;...</code></pre>
<p>We have observations on 13 different variables, namely</p>
<ul>
<li>the <code>age</code> in years</li>
<li><code>gender</code> female / male</li>
<li>school<code>grade</code> 9-12</li>
<li><code>hispanic</code> or not</li>
<li><code>race</code> White / Asian / American Indian or Alaska Native / Black or African American / Native Hawaiian or Other Pacific Islander</li>
<li><code>height</code> in meters</li>
<li><code>weight</code> in kilograms</li>
<li><code>helmet_12m</code>: how often did you wear a helmet when biking in the last 12 months? did not ride / never / rarely / sometimes / most of time / always</li>
<li><code>text_while_driving_30d</code>: how many days did you text while driving in the last 30 days?</li>
<li><code>physically_active_7d</code>: how many days were you physically active for 60+ minutes in the last 7 days?</li>
<li><code>hours_tv_per_school_day</code>: how many hours of TV do you typically watch on a school night?</li>
<li><code>strength_training_7d</code>: how many days did you do strength training (e.g. lift weights) in the last 7 days?</li>
<li><code>school_night_hours_sleep</code> how many hours of sleep do you typically get on a school night?</li>
</ul>
<p>Let’s dive some deeper using <code>skim</code>:</p>
<pre class="r"><code>skim(yrbss)</code></pre>
<table style='width: auto;'
        class='table table-condensed'>
<caption>
<span id="tab:unnamed-chunk-2">Table 1: </span>Data summary
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
yrbss
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
13583
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
13
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
empty
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:right;">
whitespace
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
gender
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
grade
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
hispanic
</td>
<td style="text-align:right;">
231
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
race
</td>
<td style="text-align:right;">
2805
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
helmet_12m
</td>
<td style="text-align:right;">
311
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
text_while_driving_30d
</td>
<td style="text-align:right;">
918
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
hours_tv_per_school_day
</td>
<td style="text-align:right;">
338
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
school_night_hours_sleep
</td>
<td style="text-align:right;">
1248
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
16.16
</td>
<td style="text-align:right;">
1.26
</td>
<td style="text-align:right;">
12.00
</td>
<td style="text-align:right;">
15.0
</td>
<td style="text-align:right;">
16.00
</td>
<td style="text-align:right;">
17.00
</td>
<td style="text-align:right;">
18.00
</td>
<td style="text-align:left;">
▁▂▅▅▇
</td>
</tr>
<tr>
<td style="text-align:left;">
height
</td>
<td style="text-align:right;">
1004
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
1.27
</td>
<td style="text-align:right;">
1.6
</td>
<td style="text-align:right;">
1.68
</td>
<td style="text-align:right;">
1.78
</td>
<td style="text-align:right;">
2.11
</td>
<td style="text-align:left;">
▁▅▇▃▁
</td>
</tr>
<tr>
<td style="text-align:left;">
weight
</td>
<td style="text-align:right;">
1004
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
67.91
</td>
<td style="text-align:right;">
16.90
</td>
<td style="text-align:right;">
29.94
</td>
<td style="text-align:right;">
56.2
</td>
<td style="text-align:right;">
64.41
</td>
<td style="text-align:right;">
76.20
</td>
<td style="text-align:right;">
180.99
</td>
<td style="text-align:left;">
▆▇▂▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
physically_active_7d
</td>
<td style="text-align:right;">
273
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
2.56
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:left;">
▆▂▅▃▇
</td>
</tr>
<tr>
<td style="text-align:left;">
strength_training_7d
</td>
<td style="text-align:right;">
1176
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
2.95
</td>
<td style="text-align:right;">
2.58
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:left;">
▇▂▅▂▅
</td>
</tr>
</tbody>
</table>
<p>We see that we have to deal with some missing data. Regarding our numerical variables, the values (min, max, histogram) seem very reasonable, even though some high schoolers seem to be quite small / tall and light / heavy.</p>
</div>
<div id="exploratory-data-analysis" class="section level2">
<h2>Exploratory Data Analysis</h2>
<p>As mentioned above, the range of <code>weight</code>s is quite big. Hence, let’s have a closer look at this variable.
First, we can see from the <code>skim</code> output that there are 1004 observations with missing weights.</p>
<p>Let’s calculate summary statistics and visualize the distribution:</p>
<pre class="r"><code># calculate weight summary statistics
yrbss_weight_summary &lt;- yrbss %&gt;% 
  filter(!is.na(weight)) %&gt;% # filter out NAs
  summarise(min = min(weight), 
            Q1 = quantile(weight, 0.25), 
            median = median(weight), 
            Q3= quantile(weight, 0.75), 
            max = max(weight),
            mean = mean(weight),
            sd = sd(weight))

# print summary statistics
yrbss_weight_summary %&gt;% 
  kbl(caption = &quot;summary statistics of the weight variable&quot;) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:eda_on_weight_1)summary statistics of the weight variable
</caption>
<thead>
<tr>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
Q1
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
Q3
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
29.9
</td>
<td style="text-align:right;">
56.2
</td>
<td style="text-align:right;">
64.4
</td>
<td style="text-align:right;">
76.2
</td>
<td style="text-align:right;">
181
</td>
<td style="text-align:right;">
67.9
</td>
<td style="text-align:right;">
16.9
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>ggplot(yrbss, aes(x = weight)) +
  geom_histogram(binwidth = 2) + # binwidth = 2kg
  # add vertical lines for the mean and the median
  geom_vline(aes(xintercept = yrbss_weight_summary$median, colour = &#39;median&#39;), linetype = 2, size = 1) +
  geom_vline(aes(xintercept = yrbss_weight_summary$mean, colour = &#39;mean&#39;), linetype = 2, size = 1) +
  # change color of vertical lines
  scale_color_manual(name = NULL, values = c(median = &quot;red&quot;, mean = &quot;blue&quot;)) +
  # show median in legend before mean
  guides(color = guide_legend(reverse = TRUE)) +
  labs(title = &quot;Distribution of weights&quot;) +
  theme_bw()</code></pre>
<p><img src="/blog/homework3_files/figure-html/eda_on_weight_2-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>We can see that the distribution is a little bit right-skewed with quite some outliers of high weights.
However, the IQR seems not too big and around 50% of the pupils have a weight between 56 and 76, which seems reasonable.
Let’s further visualise these findings with the help of a boxplot:</p>
<pre class="r"><code>ggplot(yrbss, aes(x = weight)) +
  geom_boxplot() +
  theme_bw() +
  theme(axis.text.y = element_blank(),
        axis.ticks = element_blank())</code></pre>
<p><img src="/blog/homework3_files/figure-html/eda_on_weight_3-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>Our analysis so far showed that most of the pupils seem to have normal weight. However, there are also quite some high schoolers
with too much weight. One explanation for this could be too little physical activity.<br />
Hence, let’s have a look at the relationship between a high schooler’s weight and their physical activity:</p>
<pre class="r"><code># create plot 1
yrbss %&gt;% 
  # only use observations with data for physically_active_7d and weight
  drop_na(physically_active_7d, weight) %&gt;% 
  ggplot(aes(x = factor(physically_active_7d), y = weight)) +
  geom_boxplot() + # boxplot of weight per physically_active_7d
  labs(title = &quot;no clear relationship betweeen weight and physical activeness&quot;,
       subtitle = &quot;boxplots of weight per physical activeness&quot;,
       x = &quot;days of 60+ minutes physical activeness in the last 7 days&quot;,
       y = &quot;weight&quot;) +
  theme_bw()</code></pre>
<p><img src="/blog/homework3_files/figure-html/scatterplot_weight_physical-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r"><code># create plot 2
yrbss %&gt;% 
  # only use observations with data for physically_active_7d and weight
  drop_na(physically_active_7d, weight) %&gt;% 
  ggplot(aes(x = weight, y = stat(density))) + # show density and not counts for better comparison
  geom_freqpoly(aes(color = factor(physically_active_7d))) + # visualise distribution of weight per physically_active_7d
  labs(title = &quot;no clear relationship between weight and physical activeness&quot;,
       subtitle = &quot;distribution of weights by physical activeness&quot;,
       color = &quot;days of 60+ \nminutes physical \nactiveness in the \nlast 7 days&quot;) +
  theme_bw()</code></pre>
<p><img src="/blog/homework3_files/figure-html/scatterplot_weight_physical-2.png" width="648" style="display: block; margin: auto;" /></p>
<p>There is no trend showing that higher physical activeness leads to less weight. The distributions of <code>weight</code> are almost the same for the different levels of physical activeness and it even looks like that there is a slight trend of higher physical activeness correlating with higher weight.</p>
<p>However, let’s dig deeper and see what we can find! We create a new variable <code>physical_3plus</code>, which will be <code>yes</code> if they are physically active for at least 3 days a week, and <code>no</code> otherwise.</p>
<pre class="r"><code>yrbss &lt;- yrbss %&gt;% 
  # create new variable `physical_3plus`
  mutate(physical_3plus = ifelse(physically_active_7d &gt;= 3, &quot;yes&quot;, &quot;no&quot;))

yrbss %&gt;% 
  # only use observations with data for physical_3plus
  filter(!is.na(physical_3plus)) %&gt;% 
  # group by &quot;yes&quot; / &quot;no&quot;
  group_by(physical_3plus) %&gt;% 
  # count occurence
  summarise(count = n()) %&gt;% 
  # calculate proportion
  mutate(prop= count/sum(count)) %&gt;% 
  kbl() %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
physical_3plus
</th>
<th style="text-align:right;">
count
</th>
<th style="text-align:right;">
prop
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
4404
</td>
<td style="text-align:right;">
0.331
</td>
</tr>
<tr>
<td style="text-align:left;">
yes
</td>
<td style="text-align:right;">
8906
</td>
<td style="text-align:right;">
0.669
</td>
</tr>
</tbody>
</table>
<p>We can see that approx. two third of the high schoolers are 3 or more times per week physically active for 60+ minutes!</p>
<p>Let’s create a 95% confidence interval for the population proportion of high schoolers that are <em>not</em> active 3 or more days per week:</p>
<pre class="r"><code>yrbss %&gt;% 
  # only use observations with data for physical_3plus
  filter(!is.na(physical_3plus)) %&gt;% 
  # calculate proportion for &quot;no&quot; physical_3plus
  summarise(n_yes = count(physical_3plus == &quot;yes&quot;),
            n_no = count(physical_3plus == &quot;no&quot;),
            count = n(),
            proportion = n_no / (n_yes + n_no)) %&gt;% 
  # calculate CI
  mutate(sd = sqrt(proportion*(1-proportion)/count), 
         z_critical = qnorm(0.975), 
         `lower bound` = proportion - z_critical * sd, 
         `upper bound` = proportion + z_critical * sd) %&gt;% 
  select(`lower bound`, proportion, `upper bound`) %&gt;% 
  kbl(caption = &quot;confidence interval for high schoolers that are not active 3 or more days per week&quot;) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:CI_physical_3plus)confidence interval for high schoolers that are not active 3 or more days per week
</caption>
<thead>
<tr>
<th style="text-align:right;">
lower bound
</th>
<th style="text-align:right;">
proportion
</th>
<th style="text-align:right;">
upper bound
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.323
</td>
<td style="text-align:right;">
0.331
</td>
<td style="text-align:right;">
0.339
</td>
</tr>
</tbody>
</table>
<p>Finally, we want to see if our newly created variable <code>physical_3plus</code> has a clearer relationship to <code>weight</code>:</p>
<pre class="r"><code>yrbss %&gt;% 
  # only use observations with data for physical_3plus and weight
  drop_na(physical_3plus, weight) %&gt;% 
  ggplot(aes(x = physical_3plus, y = weight)) +
  geom_boxplot() + # boxplot of weight per physical_3plus
  labs(title = &quot;Does physical activeness lead to higher weight?!&quot;,
       subtitle = &quot;boxplots of weight per physical activeness&quot;,
       x = &quot;were active for 60+ minutes on 3 days in the last 7 days&quot;,
       y = &quot;weight&quot;) +
  theme_bw()</code></pre>
<p><img src="/blog/homework3_files/figure-html/boxplot_physical_3plus-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>Just like before with the variable <code>physically_active_7d</code>, there is no clear relationship between physical activeness and weight.<br />
Opposed to our theory of higher physical activeness leading to lower weight, it even looks like there is a trend of higher physical activeness correlating with higher weight. This could be explained by older pupils with higher weight being more physically active. However, a deeper analysis is needed here!</p>
</div>
<div id="confidence-interval" class="section level2">
<h2>Confidence Interval</h2>
<p>Boxplots show how the medians of the two distributions compare, but we can also compare the means of the distributions using either a confidence interval or a hypothesis test.</p>
<pre class="r"><code>yrbss %&gt;%
  group_by(physical_3plus) %&gt;%
  # also filter out weight NAs!! Otherwise, count is too high and CI narrower than it actually is
  filter(!is.na(physical_3plus), !is.na(weight)) %&gt;% 
  summarise(mean_weight = mean(weight),
            sd_weight = sd(weight),
            count = n(),
            se_weight = sd_weight/sqrt(count),
            t_critical = qt(0.975, count-1), 
            margin_of_error = t_critical * se_weight,
            lower = mean_weight - t_critical * se_weight,
            upper = mean_weight + t_critical * se_weight
            ) %&gt;% 
  kbl(caption = &quot;confidence interval for average weight by physical activeness (physical_3plus)&quot;) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-4">Table 2: </span>confidence interval for average weight by physical activeness (physical_3plus)
</caption>
<thead>
<tr>
<th style="text-align:left;">
physical_3plus
</th>
<th style="text-align:right;">
mean_weight
</th>
<th style="text-align:right;">
sd_weight
</th>
<th style="text-align:right;">
count
</th>
<th style="text-align:right;">
se_weight
</th>
<th style="text-align:right;">
t_critical
</th>
<th style="text-align:right;">
margin_of_error
</th>
<th style="text-align:right;">
lower
</th>
<th style="text-align:right;">
upper
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
no
</td>
<td style="text-align:right;">
66.7
</td>
<td style="text-align:right;">
17.6
</td>
<td style="text-align:right;">
4022
</td>
<td style="text-align:right;">
0.278
</td>
<td style="text-align:right;">
1.96
</td>
<td style="text-align:right;">
0.545
</td>
<td style="text-align:right;">
66.1
</td>
<td style="text-align:right;">
67.2
</td>
</tr>
<tr>
<td style="text-align:left;">
yes
</td>
<td style="text-align:right;">
68.4
</td>
<td style="text-align:right;">
16.5
</td>
<td style="text-align:right;">
8342
</td>
<td style="text-align:right;">
0.180
</td>
<td style="text-align:right;">
1.96
</td>
<td style="text-align:right;">
0.354
</td>
<td style="text-align:right;">
68.1
</td>
<td style="text-align:right;">
68.8
</td>
</tr>
</tbody>
</table>
<p>There is an observed difference of about 1.77kg (68.44 - 66.67), and we notice that the two confidence intervals do not overlap. It seems that the difference is at least 95% statistically significant. Let us also conduct a hypothesis test.</p>
</div>
<div id="hypothesis-test-with-formula" class="section level2">
<h2>Hypothesis test with formula</h2>
<p>First, we conduct a traditional t-test for the following hypotheses:</p>
<p>H0: mu_1 = mu_2, i.e. mean weights are <em>not</em> different for those who exercise at least 3 times a week vs those who don’t<br />
H1: mu_1 != mu_2, i.e. mean weights <em>are</em> different for those who exercise at least 3 times a week vs those who don’t</p>
<pre class="r"><code>t.test(weight ~ physical_3plus, data = yrbss)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  weight by physical_3plus
## t = -5, df = 7479, p-value = 9e-08
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -2.42 -1.12
## sample estimates:
##  mean in group no mean in group yes 
##              66.7              68.4</code></pre>
<p>We can see that we have a very small p value, meaning that the data strongly implies that there is a difference in means.</p>
</div>
<div id="hypothesis-test-with-infer" class="section level2">
<h2>Hypothesis test with <code>infer</code></h2>
<p>Next, we want to conduct the same hypothesis tests using simulation and the <code>infer</code> package.</p>
<p>Let us initialize this simulation based test and save it as <code>obs_diff</code>:</p>
<pre class="r"><code>obs_diff &lt;- yrbss %&gt;%
  specify(weight ~ physical_3plus) %&gt;%
  calculate(stat = &quot;diff in means&quot;, order = c(&quot;yes&quot;, &quot;no&quot;)) # order yes - no</code></pre>
<p>As a second step, we simulate the test on the null distribution, which we simulate using <code>generate</code>:</p>
<pre class="r"><code># set random seed
set.seed(1234)

null_dist &lt;- yrbss %&gt;%
  specify(weight ~ physical_3plus) %&gt;%
  # set null hypothesis (no difference between the two population means)
  hypothesize(null = &quot;independence&quot;) %&gt;%
  generate(reps = 1000, type = &quot;permute&quot;) %&gt;% # permute for hypothesis testing
  calculate(stat = &quot;diff in means&quot;, order = c(&quot;yes&quot;, &quot;no&quot;))</code></pre>
<p>We can visualize this null distribution with the following code:</p>
<pre class="r"><code>ggplot(data = null_dist, aes(x = stat)) +
  geom_histogram() +
  theme_bw()</code></pre>
<p><img src="/blog/homework3_files/figure-html/unnamed-chunk-8-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>Now that the test is initialized and the null distribution formed, we can visualise to see how many of these null permutations have a difference of at least 1.77.</p>
<p>We can also calculate the p-value for the hypothesis test.</p>
<pre class="r"><code>null_dist %&gt;% visualize() +
  shade_p_value(obs_stat = obs_diff, direction = &quot;two-sided&quot;) + 
  theme_bw()</code></pre>
<p><img src="/blog/homework3_files/figure-html/unnamed-chunk-9-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r"><code>null_dist %&gt;%
  get_p_value(obs_stat = obs_diff, direction = &quot;two_sided&quot;) %&gt;% 
  kbl() %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
p_value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>This is the standard workflow for performing hypothesis tests. Again, we see that the data strongly implies that there is a difference in means.</p>
</div>
</div>
<div id="imdb-ratings-differences-between-directors" class="section level1">
<h1>IMDB ratings: Differences between directors</h1>
<p>Recall the IMBD ratings data. We want to produce a new blockbuster and have the option to either work
with Steven Spielberg or Tim Burton. As our goal is a top-rated movie, we want to find out whether the mean IMDB rating for
Steven Spielberg and Tim Burton are the same or not.</p>
<p>Looking merely at the confidence intervals for the means is not really helpful in decision making, as they overlap:</p>
<pre class="r"><code># load data
movies &lt;- read_csv(here::here(&quot;project_data&quot;, &quot;movies.csv&quot;))

# calculate CIs
formula_CI_movies &lt;- movies %&gt;% 
  # group data by director and filter for Burton and Spielberg
  group_by(director) %&gt;% 
  filter(director %in% c(&quot;Tim Burton&quot;, &quot;Steven Spielberg&quot;)) %&gt;% 
  # calculate CIs
  summarise(average_rating = mean(rating), # calculate average rating
            SD_rating = sd(rating), # calculate standard deviation
            count = n(), # get the number of observations
            t_critical = qt(0.975, count - 1), # get t-critical value with (count-1) degrees of freedom
            SE =  SD_rating/sqrt(count), # calculate standard error
            margin_of_error = t_critical * SE, # calculate margin of error
            lower_ci = average_rating - margin_of_error, # calculate lower bound of the CI
            upper_ci = average_rating + margin_of_error) # calculate upper bound of the CI

# needed for gray overlapping area
xmin_rect = formula_CI_movies %&gt;% 
  filter(director == &quot;Steven Spielberg&quot;) %&gt;% 
  select(lower_ci)

# needed for gray overlapping area
xmax_rect = formula_CI_movies %&gt;% 
  filter(director == &quot;Tim Burton&quot;) %&gt;% 
  select(upper_ci)

# plot CIs
ggplot(formula_CI_movies, aes(y=factor(director, levels = c(&quot;Tim Burton&quot;, &quot;Steven Spielberg&quot;)), 
                              x = average_rating, group = director)) +
  #draw the means
  geom_point(aes(color=director), size = 5) +
  #draws the CI error bars
  geom_errorbar(aes(xmin=lower_ci, xmax=upper_ci, color=director), width=.1, size = 2) +
  # add the lower_ci labels
  geom_text(aes(label = round(lower_ci,2), x = lower_ci),
            hjust = 0.3, # adjust position horizontally
            vjust = -1, # adjust position vertically
            size = 5) + # size of text
  # add the upper_ci labels
  geom_text(aes(label = round(upper_ci,2), x = upper_ci), 
            hjust = 0.3, # adjust position horizontally
            vjust = -1, # adjust position vertically
            size = 5) + # size of text
  # add the average labels
  geom_text(aes(label = round(average_rating,2), x = average_rating), 
            hjust = 0.4, # adjust position horizontally
            vjust = -0.8, # adjust position vertically
            size = 7) + # size of text
  # add gray overlap area
  geom_rect(aes(xmin = xmin_rect$lower_ci, xmax = xmax_rect$upper_ci, ymin = -Inf, ymax = Inf), alpha = 0.2) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  labs(title = &quot;Do Spielberg and Burton have the same mean IMDB ratings?&quot;,
       subtitle = &quot;95% confidence intervals overlap&quot;,
       y = &quot;&quot;,
       x = &quot;Mean IMDB Rating&quot;)</code></pre>
<p><img src="/blog/homework3_files/figure-html/CI_spielberg_burton-1.png" width="844.8" style="display: block; margin: auto;" /></p>
<p>Original Plot:</p>
<p><img src="D:/LBS/academy/statistics with R/my_website_project/my_website/images/directors.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Hence, let’s conduct a hypothesis test. We will both use a traditional t-test and a simulation based test with the <code>infer</code> package.</p>
<p>Our hypotheses are:</p>
<p>H0: mu_1 = mu_2, i.e. mean ratings are <em>not</em> different for Steven Spielberg and Tim Burton<br />
H1: mu_1 != mu_2, i.e. mean ratings <em>are</em> different for Steven Spielberg and Tim Burton</p>
<p>Conducting a traditional t-test yields:</p>
<pre class="r"><code>rating_test &lt;- movies %&gt;% 
  # only take relevant information
  filter(director %in% c(&quot;Tim Burton&quot;, &quot;Steven Spielberg&quot;)) %&gt;% 
  select(director, rating)
  
t.test(rating ~ director, data = rating_test)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  rating by director
## t = 3, df = 31, p-value = 0.01
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.16 1.13
## sample estimates:
## mean in group Steven Spielberg       mean in group Tim Burton 
##                           7.57                           6.93</code></pre>
<p>As a result of the traditional test, we get a test statistic with t = 3 and a p-value of 0.01. This means that under the assumption of no difference in rating means (i.e. H0), there is only a probability of 1% that we would have sampled our movies dataset or a more extreme set (with an even higher difference in rating means).
Hence, our data strongly implies that there is a difference in rating means! Assuming a alpha level of 5% (t has to be &gt;= 2), we thus reject H0.</p>
<p>Let’s now see what the result of a simulation based test is:</p>
<pre class="r"><code># calculate actual diff in means
obs_diff &lt;- rating_test %&gt;%
  specify(rating ~ director) %&gt;%
  calculate(stat = &quot;diff in means&quot;, order = c(&quot;Steven Spielberg&quot;, &quot;Tim Burton&quot;)) # order Spielberg - Burton

# simulate null distribution
null_dist &lt;- rating_test %&gt;%
  specify(rating ~ director) %&gt;%
  # set null hypothesis (no difference between the two population means)
  hypothesize(null = &quot;independence&quot;) %&gt;%
  generate(reps = 1000, type = &quot;permute&quot;) %&gt;% # permute for hypothesis testing
  calculate(stat = &quot;diff in means&quot;, order = c(&quot;Steven Spielberg&quot;, &quot;Tim Burton&quot;))

# visualise p_value and null distribution
null_dist %&gt;% visualize() +
  shade_p_value(obs_stat = obs_diff, direction = &quot;two-sided&quot;) +
  theme_bw()</code></pre>
<p><img src="/blog/homework3_files/figure-html/simulation_Spielberg_Burton-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r"><code># print out p value
null_dist %&gt;%
  get_p_value(obs_stat = obs_diff, direction = &quot;two_sided&quot;) %&gt;% 
  kbl() %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
p_value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.014
</td>
</tr>
</tbody>
</table>
<p>The p-value for the simulation based test is roughly the same as the one for our traditional test. Hence, the same interpretation holds true.</p>
</div>
<div id="omega-group-plc--pay-discrimination" class="section level1">
<h1>Omega Group plc- Pay Discrimination</h1>
<p>At the last board meeting of Omega Group Plc., the headquarters of a large multinational company, the issue was raised that women were being discriminated in the company, in the sense that the salaries were not the same for male and female executives. A quick analysis of a sample of 50 employees (of which 24 men and 26 women) revealed that the average salary for men was about 8,700 higher than for women. This seemed like a considerable difference, so it was decided that a further analysis of the company salaries was warranted.</p>
<p>The objective is to find out whether there is indeed a significant difference between the salaries of men and women, and whether the difference is due to discrimination or whether it is based on another, possibly valid, determining factor.</p>
<div id="loading-the-data" class="section level2">
<h2>Loading the data</h2>
<p>First, let’s load the data and have a look:</p>
<pre class="r"><code>omega &lt;- read_csv(here::here(&quot;project_data&quot;, &quot;omega.csv&quot;))
glimpse(omega) # examine the data frame</code></pre>
<pre><code>## Rows: 50
## Columns: 3
## $ salary     &lt;dbl&gt; 81894, 69517, 68589, 74881, 65598, 76840, 78800, 70033, ...
## $ gender     &lt;chr&gt; &quot;male&quot;, &quot;male&quot;, &quot;male&quot;, &quot;male&quot;, &quot;male&quot;, &quot;male&quot;, &quot;male&quot;, ...
## $ experience &lt;dbl&gt; 16, 25, 15, 33, 16, 19, 32, 34, 1, 44, 7, 14, 33, 19, 24...</code></pre>
<pre class="r"><code>skim(omega)</code></pre>
<table style='width: auto;'
        class='table table-condensed'>
<caption>
(#tab:load_omega_data)Data summary
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
omega
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
empty
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:right;">
whitespace
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
gender
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
salary
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
68717
</td>
<td style="text-align:right;">
8638.2
</td>
<td style="text-align:right;">
47033
</td>
<td style="text-align:right;">
63303.16
</td>
<td style="text-align:right;">
68847
</td>
<td style="text-align:right;">
74777.7
</td>
<td style="text-align:right;">
84576
</td>
<td style="text-align:left;">
▁▃▇▆▅
</td>
</tr>
<tr>
<td style="text-align:left;">
experience
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
11.9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.25
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
20.8
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:left;">
▇▃▅▂▁
</td>
</tr>
</tbody>
</table>
<p>We notice that no values are missing and that the values for gender, salary and experience seem reasonable.</p>
</div>
<div id="relationship-salary---gender" class="section level2">
<h2>Relationship Salary - Gender ?</h2>
<p>The data frame <code>omega</code> contains the salaries for the sample of 50 executives in the company. Let’s find out if we can conclude that there is a significant difference between the salaries of the male and female executives.</p>
<p>First, let’s have a look at summary statistics, boxplots and confidence intervals:</p>
<pre class="r"><code># Summary Statistics of salary by gender
mosaic::favstats(salary ~ gender, data=omega) %&gt;% 
  kbl(caption = &quot;summary statistics on salary by gender&quot;) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:CI_gender_salary)summary statistics on salary by gender
</caption>
<thead>
<tr>
<th style="text-align:left;">
gender
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
Q1
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
Q3
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
missing
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
47033
</td>
<td style="text-align:right;">
60338
</td>
<td style="text-align:right;">
64618
</td>
<td style="text-align:right;">
70033
</td>
<td style="text-align:right;">
78800
</td>
<td style="text-align:right;">
64543
</td>
<td style="text-align:right;">
7567
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
54768
</td>
<td style="text-align:right;">
68331
</td>
<td style="text-align:right;">
74675
</td>
<td style="text-align:right;">
78568
</td>
<td style="text-align:right;">
84576
</td>
<td style="text-align:right;">
73239
</td>
<td style="text-align:right;">
7463
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># plot boxplots
omega %&gt;% 
  ggplot(aes(x = gender, y = salary)) +
  geom_boxplot() + # boxplot of salary per male/female
  labs(title = &quot;men earn more than women!&quot;,
       subtitle = &quot;boxplots of salary per gender&quot;,
       x = &quot;&quot;) +
  theme_bw()</code></pre>
<p><img src="/blog/homework3_files/figure-html/CI_gender_salary-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r"><code># calculate CIs for gender male and female
CI_omega &lt;- omega %&gt;% 
  # group by gender and calculate mean, SD, sample size, t-critical value, SE and MoE
  group_by(gender) %&gt;% 
  summarise(mean = mean(salary), # calculate average salary
            SD = sd(salary), # calculate standard deviation
            `sample size` = n(), # get the number of observations
            `t-critical value` = qt(0.975, `sample size` - 1), # get t-critical value with (`sample size`-1) degrees of freedom
            `standard error` =  SD/sqrt(`sample size`), # calculate standard error
            `margin of error` = `t-critical value` * `standard error`, # calculate margin of error
            `lower CI bound` = mean - `margin of error`, # calculate lower bound of the CI
            `upper CI bound` = mean + `margin of error`) # calculate upper bound of the CI

# print table with CIs
CI_omega %&gt;% 
  kbl(caption = &quot;95% confidence interval on average salary&quot;) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:CI_gender_salary)95% confidence interval on average salary
</caption>
<thead>
<tr>
<th style="text-align:left;">
gender
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
SD
</th>
<th style="text-align:right;">
sample size
</th>
<th style="text-align:right;">
t-critical value
</th>
<th style="text-align:right;">
standard error
</th>
<th style="text-align:right;">
margin of error
</th>
<th style="text-align:right;">
lower CI bound
</th>
<th style="text-align:right;">
upper CI bound
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
64543
</td>
<td style="text-align:right;">
7567
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
2.06
</td>
<td style="text-align:right;">
1484
</td>
<td style="text-align:right;">
3056
</td>
<td style="text-align:right;">
61486
</td>
<td style="text-align:right;">
67599
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
73239
</td>
<td style="text-align:right;">
7463
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
2.07
</td>
<td style="text-align:right;">
1523
</td>
<td style="text-align:right;">
3151
</td>
<td style="text-align:right;">
70088
</td>
<td style="text-align:right;">
76390
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># plot CIs
ggplot(CI_omega, aes(y=gender, x = mean, group = gender, color=gender)) +
  #draws the means
  geom_point(size = 5) +
  #draws the CI error bars
  geom_errorbar(aes(xmin=`lower CI bound`, xmax=`upper CI bound`), width=.1, size = 2) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  labs(title = &quot;95% confidence intervals on salary by gender do not overlap&quot;,
       y = &quot;&quot;,
       x = &quot;salary&quot;)</code></pre>
<p><img src="/blog/homework3_files/figure-html/CI_gender_salary-2.png" width="648" style="display: block; margin: auto;" /></p>
<p>As the two confidence intervals do not overlap, it seems that the difference is at least 95% statistically significant. Let us also conduct a hypothesis test.</p>
<p>Our hypotheses are as follows:</p>
<p>H0: mu_1 = mu_2, i.e. mean salaries are <em>not</em> different for men and women<br />
H1: mu_1 != mu_2, i.e. mean salaries <em>are</em> different for men and women</p>
<p>Conducting a traditional t-test yields:</p>
<pre class="r"><code>t.test(salary ~ gender, data = omega)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  salary by gender
## t = -4, df = 48, p-value = 2e-04
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -12973  -4420
## sample estimates:
## mean in group female   mean in group male 
##                64543                73239</code></pre>
<p>As a result of the traditional test, we get a test statistic with t = -4 and a p-value of close to zero. This means that under the assumption of no difference in salary means (i.e. H0), there is only a very very small probability that we would have sampled our omega dataset or a more extreme set (with an even higher difference in salary means).
Hence, our data strongly implies that there is a difference in salary means! Assuming a alpha level of 5% (t has to be &lt;= -2), we thus reject H0.</p>
<p>Let’s now see what the result of a simulation based test is:</p>
<pre class="r"><code># calculate actual diff in means
obs_diff &lt;- omega %&gt;%
  specify(salary ~ gender) %&gt;%
  calculate(stat = &quot;diff in means&quot;, order = c(&quot;male&quot;, &quot;female&quot;)) # order male - female

# simulate null distribution
null_dist &lt;- omega %&gt;%
  specify(salary ~ gender) %&gt;%
  # set null hypothesis (no difference between the two population means)
  hypothesize(null = &quot;independence&quot;) %&gt;%
  generate(reps = 1000, type = &quot;permute&quot;) %&gt;% # permute for hypothesis testing
  calculate(stat = &quot;diff in means&quot;, order = c(&quot;male&quot;, &quot;female&quot;))

# visualise p_value and null distribution
null_dist %&gt;% visualize() +
  shade_p_value(obs_stat = obs_diff, direction = &quot;two-sided&quot;) +
  theme_bw()</code></pre>
<p><img src="/blog/homework3_files/figure-html/simulation_gender_salary-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r"><code># print out p value
null_dist %&gt;%
  get_p_value(obs_stat = obs_diff, direction = &quot;two_sided&quot;) %&gt;% 
  kbl() %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
p_value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>The p-value for the simulation based test is basically the same as the one for our traditional test. Hence, the same interpretation holds true.</p>
<p>All in all, we can be quite certain that there really is a difference in mean salary between men and women. However, this does not mean that there is a direct causality between those two variables. It is possible that for example most women have less experience than men in this dataset, which would explain the lower average salary. Hence, it is still possible that there is no “real” gender pay gap. However, at the moment it looks like the gender pay gap is reality!</p>
</div>
<div id="relationship-experience---gender" class="section level2">
<h2>Relationship Experience - Gender?</h2>
<p>We want to dig deeper on the concerns we have just raised and have a look at the relationship between experience and gender.<br />
Indeed, the average experience of the men is approximately 21 years, whereas the women only have about 7 years experience on average:</p>
<pre class="r"><code>favstats (experience ~ gender, data=omega) %&gt;% 
  kbl(caption = &quot;summary statistics on experience by gender&quot;) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:experience_stats)summary statistics on experience by gender
</caption>
<thead>
<tr>
<th style="text-align:left;">
gender
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
Q1
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
Q3
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
missing
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
14.0
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
7.38
</td>
<td style="text-align:right;">
8.51
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
15.75
</td>
<td style="text-align:right;">
19.5
</td>
<td style="text-align:right;">
31.2
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
21.12
</td>
<td style="text-align:right;">
10.92
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>Let’s also have a look at boxplots and confidence intervals:</p>
<pre class="r"><code># plot boxplots
omega %&gt;% 
  ggplot(aes(x = gender, y = experience)) +
  geom_boxplot() + # boxplot of experience per male/female
  labs(title = &quot;men at omega have more experience than women!&quot;,
       subtitle = &quot;boxplots of experience per gender&quot;,
       x = &quot;&quot;) +
  theme_bw()</code></pre>
<p><img src="/blog/homework3_files/figure-html/CI_gender_experience-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r"><code># calculate CIs for gender male and female
CI_omega &lt;- omega %&gt;% 
  # group by gender and calculate mean, SD, sample size, t-critical value, SE and MoE
  group_by(gender) %&gt;% 
  summarise(mean = mean(experience), # calculate average
            SD = sd(experience), # calculate standard deviation
            `sample size` = n(), # get the number of observations
            `t-critical value` = qt(0.975, `sample size` - 1), # get t-critical value with (`sample size`-1) degrees of freedom
            `standard error` =  SD/sqrt(`sample size`), # calculate standard error
            `margin of error` = `t-critical value` * `standard error`, # calculate margin of error
            `lower CI bound` = mean - `margin of error`, # calculate lower bound of the CI
            `upper CI bound` = mean + `margin of error`) # calculate upper bound of the CI

# print table with CIs
CI_omega %&gt;% 
  kbl(caption = &quot;95% confidence intervals on average experience&quot;) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:CI_gender_experience)95% confidence intervals on average experience
</caption>
<thead>
<tr>
<th style="text-align:left;">
gender
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
SD
</th>
<th style="text-align:right;">
sample size
</th>
<th style="text-align:right;">
t-critical value
</th>
<th style="text-align:right;">
standard error
</th>
<th style="text-align:right;">
margin of error
</th>
<th style="text-align:right;">
lower CI bound
</th>
<th style="text-align:right;">
upper CI bound
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
7.38
</td>
<td style="text-align:right;">
8.51
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
2.06
</td>
<td style="text-align:right;">
1.67
</td>
<td style="text-align:right;">
3.44
</td>
<td style="text-align:right;">
3.95
</td>
<td style="text-align:right;">
10.8
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
21.12
</td>
<td style="text-align:right;">
10.92
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
2.07
</td>
<td style="text-align:right;">
2.23
</td>
<td style="text-align:right;">
4.61
</td>
<td style="text-align:right;">
16.52
</td>
<td style="text-align:right;">
25.7
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># plot CIs
ggplot(CI_omega, aes(y=gender, x = mean, group = gender, color=gender)) +
  #draws the means
  geom_point(size = 5) +
  #draws the CI error bars
  geom_errorbar(aes(xmin=`lower CI bound`, xmax=`upper CI bound`), width=.1, size = 2) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;) +
  labs(title = &quot;95% confidence intervals on experience by gender do not overlap&quot;,
       y = &quot;&quot;,
       x = &quot;experience&quot;)</code></pre>
<p><img src="/blog/homework3_files/figure-html/CI_gender_experience-2.png" width="648" style="display: block; margin: auto;" /></p>
<p>As the two confidence intervals do not overlap, it seems that the difference is at least 95% statistically significant. Let us also conduct a hypothesis test.</p>
<p>Our hypotheses are as follows:</p>
<p>H0: mu_1 = mu_2, i.e. mean experiences are <em>not</em> different for men and women<br />
H1: mu_1 != mu_2, i.e. mean experiences <em>are</em> different for men and women</p>
<p>Conducting a traditional t-test yields:</p>
<pre class="r"><code>t.test(experience ~ gender, data = omega)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  experience by gender
## t = -5, df = 43, p-value = 1e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -19.35  -8.13
## sample estimates:
## mean in group female   mean in group male 
##                 7.38                21.12</code></pre>
<p>As a result of the traditional test, we get a test statistic with t = -5 and a p-value of close to zero. This means that under the assumption of no difference in experience means (i.e. H0), there is only a very very small probability that we would have sampled our omega dataset or a more extreme set (with an even higher difference in experience means).
Hence, our data strongly implies that there is a difference in experience means! Assuming a alpha level of 5% (t has to be &lt;= -2), we thus reject H0.</p>
<p>Let’s now see what the result of a simulation based test is:</p>
<pre class="r"><code># calculate actual diff in means
obs_diff &lt;- omega %&gt;%
  specify(experience ~ gender) %&gt;%
  calculate(stat = &quot;diff in means&quot;, order = c(&quot;male&quot;, &quot;female&quot;)) # order male - female

# simulate null distribution
null_dist &lt;- omega %&gt;%
  specify(experience ~ gender) %&gt;%
  # set null hypothesis (no difference between the two population means)
  hypothesize(null = &quot;independence&quot;) %&gt;%
  generate(reps = 1000, type = &quot;permute&quot;) %&gt;% # permute for hypothesis testing
  calculate(stat = &quot;diff in means&quot;, order = c(&quot;male&quot;, &quot;female&quot;))

# visualise p_value and null distribution
null_dist %&gt;% visualize() +
  shade_p_value(obs_stat = obs_diff, direction = &quot;two-sided&quot;) +
  theme_bw()</code></pre>
<p><img src="/blog/homework3_files/figure-html/simulation_gender_experience-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r"><code># print out p value
null_dist %&gt;%
  get_p_value(obs_stat = obs_diff, direction = &quot;two_sided&quot;) %&gt;% 
  kbl() %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
p_value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>The p-value for the simulation based test is basically the same as the one for our traditional test. Hence, the same interpretation holds true.</p>
<p>All in all, we can be quite certain that there really is a difference in mean experience between men and women.<br />
This could definitely explain why women are paid less than men!</p>
</div>
<div id="relationship-salary---experience" class="section level2">
<h2>Relationship Salary - Experience ?</h2>
<p>Due to our findings above, a more thorough analysis of the relationship between salary and experience is required before any conclusion can be drawn about whether there is any gender-based salary discrimination in the company.</p>
<p>Hence, have a look at the following graphs:</p>
<pre class="r"><code>ggplot(omega, aes(x = experience, y = salary)) +
  geom_point(aes(color = gender)) +
  geom_smooth(method = lm, se = FALSE) +
  theme_bw() +
  labs(title = &quot;higher experience means higher salary&quot;)</code></pre>
<p><img src="/blog/homework3_files/figure-html/salary_exp_scatter-1.png" width="648" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(omega, aes(x = experience, y = salary, color = gender)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE) +
  theme_bw() +
  labs(title = &quot;higher experience means higher salary&quot;)</code></pre>
<p><img src="/blog/homework3_files/figure-html/salary_exp_scatter-2.png" width="648" style="display: block; margin: auto;" /></p>
<p>This reinforces our reasoning above: Higher experience leads to a higher salary. But as the women in our dataset have overally less experience than the men, this also means that they are paid less. However, this is probably mainly due to the difference in experience.</p>
</div>
<div id="check-correlations-between-the-data" class="section level2">
<h2>Check correlations between the data</h2>
<p>Finally, let’s have a look at the following graph:</p>
<pre class="r"><code>omega %&gt;% 
  select(gender, experience, salary) %&gt;% # order variables they will appear in ggpairs()
  ggpairs(aes(colour=gender, alpha = 0.3)) + # create scatterplot and correlation matrix, color by gender
  theme_bw()</code></pre>
<p><img src="/blog/homework3_files/figure-html/ggpairs-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>Especially the salary vs experience scatterplot colored by gender is quite revealing: Looking only at experiences &gt;0, we can clearly see that women are in general <em>not</em> paid less than men. The pattern between male / female is quite random, with sometimes men being paid better (given fixed experience) and sometimes women being paid better (given fixed experience). Hence, the gender pay gap seems to be disproved.<br />
However, there are quite some women with 0 experience. Those are also the ones that are paid least. As there are no men in our data with 0 experience, it is hard to tell if women with 0 experience are systematically discriminated.</p>
</div>
</div>
<div id="challenge-1-brexit-plot" class="section level1">
<h1>Challenge 1: Brexit plot</h1>
<p>Plot Reproduction:</p>
<pre class="r"><code># load brexit data
brexit_results &lt;- read_csv(here::here(&quot;project_data&quot;,&quot;brexit_results.csv&quot;))

brexit_results %&gt;% 
  # get party vote percentages into long format (one column with party names, another with the percentages)
  pivot_longer(cols = con_2015:ukip_2015, names_to = &quot;party&quot;, values_to = &quot;party_percent&quot;) %&gt;% 
  # label the parties with readable names
  mutate(party = factor(party, labels = c(&quot;Conservative&quot;, &quot;Labour&quot;, &quot;Lib Dems&quot;, &quot;UKIP&quot;))) %&gt;% 
  # ggplot framework, color by party
  ggplot(aes(x = party_percent, y = leave_share, color = party)) +
  # add scatterplot with opacity 0.3
  geom_point(alpha = 0.3) + 
  # add linear smoothing line for each party
  geom_smooth(method = lm) +
  # use party-specific colors
  scale_color_manual(values=c(&quot;#0087dc&quot;, &quot;#d50000&quot;, &quot;#FDBB30&quot;, &quot;#EFE600&quot;)) + # change colors
  # bw theme
  theme_bw() +
  # labels
  labs(title = &quot;How political affiliation translated to Brexit Voting&quot;,
       x = &quot;Party % in the UK 2015 general election&quot;, 
       y = &quot;Leave % in the 2016 Brexit referendum&quot;) +
  # have legend vertically on the bottom with no title
  theme(legend.position = &quot;bottom&quot;,
        legend.box = &quot;vertical&quot;,
        legend.title = element_blank())</code></pre>
<p><img src="/blog/homework3_files/figure-html/uk_challenge-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Original Plot:</p>
<p><img src="D:/LBS/academy/statistics with R/my_website_project/my_website/images/brexit.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="challenge-2gdp-components-over-time-and-among-countries" class="section level1">
<h1>Challenge 2:GDP components over time and among countries</h1>
<p>At the risk of oversimplifying things, the main components of gross domestic product, GDP are personal consumption (C), business investment (I), government spending (G) and net exports (exports - imports). You can read more about GDP and the different approaches in calculating at the <a href="https://en.wikipedia.org/wiki/Gross_domestic_product">Wikipedia GDP page</a>.</p>
<p>The GDP data we will look at is from the <a href="https://unstats.un.org/unsd/snaama/Downloads">United Nations’ National Accounts Main Aggregates Database</a>, which contains estimates of total GDP and its components for all countries from 1970 to today. We will look at how GDP and its components have changed over time, and compare different countries and how much each component contributes to that country’s GDP. The file we will work with is <a href="http://unstats.un.org/unsd/amaapi/api/file/6">GDP and its breakdown at constant 2010 prices in US Dollars</a>.</p>
<pre class="r"><code>UN_GDP_data  &lt;- read_excel(here::here(&quot;project_data&quot;, &quot;Download-GDPconstant-USD-countries.xls&quot;), # Excel filename
                sheet=&quot;Download-GDPconstant-USD-countr&quot;, # Sheet name
                skip=2) # Number of rows to skip</code></pre>
<p>We first tidy up the data, as it is in wide format. Furthermore, we divide by <code>1e9</code> to express all figures in billions and rename
the indicators into something shorter.</p>
<pre class="r"><code># for the values remapping / renaming
from = c(&quot;Household consumption expenditure (including Non-profit institutions serving households)&quot;,
         &quot;General government final consumption expenditure&quot;,
         &quot;Exports of goods and services&quot;,
         &quot;Imports of goods and services&quot;)

to = c(&quot;Household expenditure&quot;,
       &quot;Government expenditure&quot;,
       &quot;Exports&quot;,
       &quot;Imports&quot;)

tidy_GDP_data &lt;- UN_GDP_data %&gt;% 
  # bring into long format
  pivot_longer(cols = `1970`:`2017`, names_to = &quot;year&quot;, values_to = &quot;values&quot;) %&gt;% 
  # express in billions
  mutate(values = values / 1e9) %&gt;% 
  # rename indicators
  mutate(IndicatorName = plyr::mapvalues(IndicatorName, from, to))


# let&#39;s have a look at the data
glimpse(tidy_GDP_data)</code></pre>
<pre><code>## Rows: 176,880
## Columns: 5
## $ CountryID     &lt;dbl&gt; 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,...
## $ Country       &lt;chr&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghani...
## $ IndicatorName &lt;chr&gt; &quot;Final consumption expenditure&quot;, &quot;Final consumption e...
## $ year          &lt;chr&gt; &quot;1970&quot;, &quot;1971&quot;, &quot;1972&quot;, &quot;1973&quot;, &quot;1974&quot;, &quot;1975&quot;, &quot;1976...
## $ values        &lt;dbl&gt; 5.56, 5.33, 5.20, 5.75, 6.15, 6.32, 6.37, 6.90, 7.09,...</code></pre>
<pre class="r"><code># Let us compare GDP components for these 3 countries
country_list &lt;- c(&quot;United States&quot;,&quot;India&quot;, &quot;Germany&quot;)</code></pre>
<p>Plot Reproduction:</p>
<pre class="r"><code># create plot
tidy_GDP_data %&gt;% 
  # only visualise for countries in the country_list
  filter(Country %in% country_list) %&gt;% 
  # only visualise certain indicators
  filter(IndicatorName %in% c(&quot;Gross capital formation&quot;, 
                              &quot;Exports&quot;, 
                              &quot;Government expenditure&quot;, 
                              &quot;Household expenditure&quot;, 
                              &quot;Imports&quot;)) %&gt;% 
  # make indicator a factor with correct ordering
  mutate(IndicatorName = factor(IndicatorName, 
                                levels = c(&quot;Gross capital formation&quot;,
                                           &quot;Exports&quot;,
                                           &quot;Government expenditure&quot;,
                                           &quot;Household expenditure&quot;,
                                           &quot;Imports&quot;))) %&gt;% 
  # ggplot framework
  ggplot(aes(x = year, y = values, color = IndicatorName)) +
  # add lines
  geom_line(aes(group = IndicatorName), size = 0.8) + 
  # faceting by country
  facet_wrap(~Country) +
  # custom scale breaks
  scale_x_discrete(breaks = c(1970, 1980, 1990, 2000, 2010)) +
  # bw theme
  theme_bw() +
  # labels (also for the legend)
  labs(title = &quot;GDP components over time&quot;,
       subtitle = &quot;In constant 2010 USD&quot;,
       x = &quot;&quot;,
       y = &quot;Billion US$&quot;,
       color = &quot;Components of GDP&quot;)</code></pre>
<p><img src="/blog/homework3_files/figure-html/challenge_2_1-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>original Plot:</p>
<p><img src="D:/LBS/academy/statistics with R/my_website_project/my_website/images/gdp1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Secondly, recall that GDP is the sum of Household Expenditure (Consumption <em>C</em>), Gross Capital Formation (business investment <em>I</em>), Government Expenditure (G) and Net Exports (exports - imports). Even though there is an indicator <code>Gross Domestic Product (GDP)</code> in the dataframe, we calculate it given its components discussed above.</p>
<pre class="r"><code># wrangle data and calculate GDP
tidy_GDP_data_2 &lt;- tidy_GDP_data %&gt;% 
  # bring in wide format to easily calculate GDP
  pivot_wider(names_from = IndicatorName, values_from = values) %&gt;% 
  # calculate Net Exports, GDP and % difference in GDPs
  mutate(`Net Exports` = Exports-Imports,
         `Calculated GDP` = `Household expenditure` + `Gross capital formation` + `Government expenditure` + `Net Exports`,
         `Percentage Change` = (`Calculated GDP` - `Gross Domestic Product (GDP)`)/`Gross Domestic Product (GDP)`)

# summary statistics
mosaic::favstats(~`Percentage Change`, data=tidy_GDP_data_2) %&gt;% 
  kbl(caption = &quot;overall summary statistics for the % difference between calculated and included GDP&quot;) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:GDP_calculation)overall summary statistics for the % difference between calculated and included GDP
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
Q1
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
Q3
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
missing
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
-0.549
</td>
<td style="text-align:right;">
-0.021
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.022
</td>
<td style="text-align:right;">
1.16
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.087
</td>
<td style="text-align:right;">
9574
</td>
<td style="text-align:right;">
986
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># summary statistics
#mosaic::favstats(`Percentage Change`~year, data=tidy_GDP_data_2) %&gt;% 
#  kbl(caption = &quot;summary statistics for the % difference between calculated and included GDP per year&quot;) %&gt;%
#  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) # have a nice HTML table</code></pre>
<p>As we can see, the % difference of the two GDPs is in most cases around 0, i.e. both GDPs are in most cases approximately the same.</p>
<p>Plot Reproduction:</p>
<pre class="r"><code># prepare data and plot
tidy_GDP_data_2 %&gt;% 
  # calculate the percentage values
  mutate(`Government Expenditure` = `Government expenditure` / `Gross Domestic Product (GDP)`,
         `Gross capital formation` = `Gross capital formation` / `Gross Domestic Product (GDP)`,
         `Household Expenditure` = `Household expenditure` / `Gross Domestic Product (GDP)`,
         `Net Exports` = `Net Exports` / `Gross Domestic Product (GDP)`) %&gt;% 
  # bring back into long format
  pivot_longer(cols = `Final consumption expenditure`:`Household Expenditure`, 
               names_to = &quot;IndicatorName&quot;, 
               values_to = &quot;values&quot;) %&gt;% 
  # only visualise for countries in the country_list
  filter(Country %in% country_list) %&gt;% 
  # only visualise certain indicators
  filter(IndicatorName %in% c(&quot;Gross capital formation&quot;, 
                              &quot;Government Expenditure&quot;, 
                              &quot;Household Expenditure&quot;, 
                              &quot;Net Exports&quot;)) %&gt;% 
  # ggplot framework
  ggplot(aes(x = year, y = values, color = IndicatorName)) +
  # add lines
  geom_line(aes(group = IndicatorName), size = 0.8) + 
  # faceting by country
  facet_wrap(~Country) +
  # custom scale breaks
  scale_x_discrete(breaks = c(1970, 1980, 1990, 2000, 2010)) +
  # percentage scale on y axis
  scale_y_continuous(labels = scales::percent) +
  # bw theme
  theme_bw() +
  # labels
  labs(title = &quot;GDP and its breakdown at constant 2010 prices in US Dollars&quot;,
       caption = &quot;Source: United Nations, https://unstats.un.org/unsd/snaama/Downloads&quot;,
       x = &quot;&quot;,
       y = &quot;proportion&quot;) +
  # no legend title
  theme(legend.title = element_blank())</code></pre>
<p><img src="/blog/homework3_files/figure-html/challenge_2_2-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>Original Plot:</p>
<p><img src="D:/LBS/academy/statistics with R/my_website_project/my_website/images/gdp2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>First, let’s have a look at the net export proportion. In India and the United States, there is a trend towards higher imports as opposed to lower exports. For Germany, we can see the opposite effect, meaning that its net exports are growing at a higher rate than its overall GDP.
Regarding the proportion of gross capital formation, i.e. investments, we can see that there is a sharp rise in India in the 2000s. In the US, the proportion of GCF is also slightly rising, whereas the proportion in Germany dropped.<br />
The proportion of Government expenditure is quite steady in India and Germany, whereas it dropped in the US.<br />
Finally, household expenditure dropped significantly in India (with the investments going up), wheres they are steady in Germany and rising in the US.</p>
<p>All in all, we can conclude the following:</p>
<ul>
<li>Proportions in Germany are quite steady, with its net exports rate rising</li>
<li>In India, businesses are more and more investing, while the household expenditure rate drops</li>
<li>While government expenditure rates drop, households and businesses (have to) invest more in the US. This can be well explained by the rise of neo-liberalism and a lower influence of the public sector</li>
</ul>
</div>
<div id="details" class="section level1">
<h1>Details</h1>
<ul>
<li>Who did you collaborate with: Noor Alameri, Brigita Angkasa, Lujia Huang, Martino Armanini, Marco Laube, Deniz Oezdemir</li>
<li>Approximately how much time did you spend on this problem set: 10h</li>
<li>What, if anything, gave you the most trouble: Details, Details, Details</li>
</ul>
</div>
<div id="rubric" class="section level1">
<h1>Rubric</h1>
<p>Check minus (1/5): Displays minimal effort. Doesn’t complete all components. Code is poorly written and not documented. Uses the same type of plot for each graph, or doesn’t use plots appropriate for the variables being analyzed.</p>
<p>Check (3/5): Solid effort. Hits all the elements. No clear mistakes. Easy to follow (both the code and the output).</p>
<p>Check plus (5/5): Finished all components of the assignment correctly and addressed both challenges. Code is well-documented (both self-documented and with additional comments as necessary). Used tidyverse, instead of base R. Graphs and tables are properly labelled. Analysis is clear and easy to follow, either because graphs are labeled clearly or you’ve written additional text to describe how you interpret the output.</p>
</div>

              </div>
          </div>
      </div>
  </div>
</section>


    </div>
    <section class="contact" id="contact">
  <div class="contact__background_shape">
      <svg viewBox="0 0 1920 79">
          <path d="M0 0h1920v79L0 0z" data-name="Path 1450" />
      </svg>
  </div>
  <div class="container">
      <div class="row">
          <div class="col-lg-12">
              <div class="contact__cta">
                  <div class="shape-1">
                      <svg xmlns="http://www.w3.org/2000/svg" width="357" height="315.029" viewBox="0 0 357 315.029">
                          <path data-name="Path 1449" d="M76.1-157.222C91.746-135.8 87.2-94.273 99.993-61.945c12.7 32.328 42.661 55.459 39.248 73.282-3.318 17.823-40.007 30.337-65.6 43.325-25.5 12.988-39.912 26.545-60.01 42.566-20.1 16.116-46.074 34.6-63.328 27.682-17.349-6.921-25.976-39.153-59.915-59.82s-93.1-29.768-105.325-51.478 22.373-56.028 43.609-93.949c21.331-37.921 29.2-79.35 53.563-96.793 24.459-17.444 65.414-10.9 103.9-6.921 38.396 3.982 74.326 5.404 89.965 26.829z" transform="translate(217.489 188.626)"/>
                      </svg>
                  </div>
                  <div class="shape-2">
                      <svg xmlns="http://www.w3.org/2000/svg" width="357" height="315.029" viewBox="0 0 357 315.029">
                          <path data-name="Path 1449" d="M76.1-157.222C91.746-135.8 87.2-94.273 99.993-61.945c12.7 32.328 42.661 55.459 39.248 73.282-3.318 17.823-40.007 30.337-65.6 43.325-25.5 12.988-39.912 26.545-60.01 42.566-20.1 16.116-46.074 34.6-63.328 27.682-17.349-6.921-25.976-39.153-59.915-59.82s-93.1-29.768-105.325-51.478 22.373-56.028 43.609-93.949c21.331-37.921 29.2-79.35 53.563-96.793 24.459-17.444 65.414-10.9 103.9-6.921 38.396 3.982 74.326 5.404 89.965 26.829z" transform="translate(217.489 188.626)"/>
                      </svg>
                  </div>
                  <div class="contact__cta_content">
                      <span>Contact me</span>
                      <h1>Let’s Start a Project</h1>
                  </div>
                  <div class="contact__cta_action">
                      <a href="/contact">Get in touch</a>
                  </div>
              </div>
          </div>
      </div>
      <div class="row contact__widget">
          <div class="col-lg-4">
              <div class="contact__widget_logo">
                  <img src="/images/contact/widget-logo.png" alt="widget-logo">
              </div>
          </div>
          <div class="col-lg-4">
              <div class="contact__widget_sitemap">
                  <h3>Sitemap</h3>
                  <ul>
                      
                      
                        <li><a href="/home">About me</a></li>
                      
                        <li><a href="/blog">Latest Article</a></li>
                      
                  </ul>
              </div>
          </div>
          <div class="col-lg-4">
              <div class="contact__widget_address">
                  <h3>Address</h3>
                  
                  <ul>
                      <li><a href="tel:&#43;44%20%280%2920%207000%207000"><i class="fa fa-phone"></i>&#43;44 (0)20 7000 7000</a></li> 
                      <li><a href="mailto:lhuang.mam2021@london.edu"><i class="fa fa-envelope"></i>lhuang.mam2021@london.edu</a></li>
                      <li><p><i class="fa fa-map-marker"></i>London Business School, Regent&#39;s Park, London, United Kingdom</p></li>
                  </ul>
              </div>
          </div>
      </div>
      <div class="row contact__footer">
          <div class="col-lg-6">
              <div class="contact__footer_copy">
                  <p></p>
              </div>
          </div>
          <div class="col-lg-6">
              <div class="contact__footer_social">
                  <ul>
                      <li><a href="https://www.linkedin.com/in/lujia-huang/"><i class="fa fa-linkedin-square"></i></a></li>
                      <li><a href="https://www.instagram.com/luciaaa2723/"><i class="fa fa-instagram" aria-hidden="true"></i></a></li>
                      <li><a href="https://www.facebook.com/lujia.huang.7/"><i class="fa fa-facebook-square" aria-hidden="true"></i></a></li>
                      <li><a href="https://twitter.com/huang_lujia"><i class="fa fa-twitter"></i></a></li>
                  </ul>
              </div>
          </div>
      </div>
  </div>
</section>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB2JuE_JhKjvzQsSxuV8p7XD-fq2uzLgGk&libraries=geometry"></script>
<script src="/plugins/jQuery/jquery.min.js"></script>
<script src="/plugins/bootstrap/bootstrap.min.js"></script>
<script src="/plugins/slick/slick.min.js"></script>
<script src="/plugins/slick/slick.min.js"></script>
<script src="/plugins/waypoint/jquery.waypoints.min.js"></script>
<script src="/plugins/magnafic-popup/jquery.magnific-popup.min.js"></script>
<script src="/plugins/tweenmax/TweenMax.min.js"></script>
<script src="/plugins/masonry/masonry.min.js"></script>

<script src="/js/form-handler.min.js"></script>

<script src="/js/script.min.js"></script>
  </body>
</html>
